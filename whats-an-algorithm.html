<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>What's an algorithm? | DEMO</title>
    <meta name="description" content="What's an algorithm?.">
    <meta name="keywords" content="">
    <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="vendor/flatstrap/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="vendor/flatstrap/assets/css/bootstrap-responsive.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script type="text/javascript" src="https://scorm-wrapper.go1.co/easyXDM/easyXDM.min.js"></script>
    <script type="text/javascript">
      easyXDM.DomHelper.requiresJSON("https://scorm-wrapper.go1.co/easyXDM/json2.js");
    </script>
  </head>
  <body>
    <div class="container">
      <header>
        <article>
          <div class="span6">
            <h1>SCORM Wrapper Demo</h1>
          </div>
        </article>
      </header>
      <div class="row">
        <article>
          <div class="span12">
            <h2 class="title">Overview</h2>
            <p>
              An algorithm is a method of solving problems both big and small. Though computers run algorithms constantly, humans can also solve problems with algorithms. David J. Malan explains how algorithms can be used in seemingly simple situations and also complex ones.
            </p>
          </div>
        </article>
      </div>
      <div class="row">
        <article>
          <div class="span12">
            <h2 class="title">Content</h2>
            <p>
              <iframe width="560" height="315" src="https://www.youtube.com/embed/6hfOvs8pY1k" frameborder="0" allowfullscreen></iframe>
            </p>
          </div>
        </article>
      </div>
      <footer>
        <div class="row footer inversed">
          <div class="span12">
          </div>
        </div>
      </footer>
    </div>
    <!-- Wrapper code -->
    <script type="text/javascript">
      var remote = new easyXDM.Rpc({
          local: "https://scorm-wrapper.go1.co/easyXDM/name.html",
          swf: "https://scorm-wrapper.go1.co/easyXDM/easyxdm.swf"
      }, {
          remote: {
              status: {},
              close: {}
          }
      });
      var ScormService = function (data) {
          console.log("The provider in process to send course information back to the consumer:", data);
          if (window.ScormService_MAPPING_DATA) {
              var sw = ScormService_MAPPING_DATA.objectives;
              if (sw && sw.length) {
                  var score = 0,
                      scoreweight = 0,
                      progress = 0,
                      progressweight = 0;
                  for (var c = 0; c < sw.length; c++) {
                      if (data.objectives[sw[c].id]) {
                          scoreweight += sw[c].scoreweight;
                          progressweight += sw[c].progressweight;
                          progress += sw[c].progressweight * data.objectives[sw[c].id].progress;
                          score += sw[c].scoreweight * data.objectives[sw[c].id].score;
                      }
                  }
                  if (progressweight > 0) {
                      progress /= progressweight;
                      data.course.progress = Math.round(progress);
                  } else {
                      data.progress = 0;
                  }
                  if (scoreweight > 0) {
                      score /= scoreweight;
                      data.course.score = Math.round(score);
                  }
              }
          }
          if (remote && remote.status) {
              console.log("The provider now invoking remote.status to send data to consumer frame:", data);
              remote.status(data, function (d) {
              });
          }
      };
      // Mapping data to re-calculate score.
      var ScormService_MAPPING_DATA = {
          "objectives": [{
              "id": "COURSE1",
              "title": "What's an algorithm?",
              "progressweight": "100",
              "scoreweight": "100"
          }]
      };
      var enrollment = {
          page: "https://tiensi.me/whats-an-algorithm.html",
          started: "2017-11-16T13:50:34Z+0930",
          completed: "2017-11-16T13:50:34Z+0930",
          progress: "100",
          score: "100",
          course: {
              started: "2017-11-16T13:50:34Z+0930",
              completed: "2017-11-16T13:50:34Z+0930"
          },
          objectives: {
              "COURSE1": {
                  title: "What's an algorithm?",
                  started: "2017-11-16T13:50:34Z+0930",
                  completed: "2017-11-16T13:50:34Z+0930",
                  progress: "100",
                  score: "100"
              }
          }
      };
      if (window.ScormService) {
          window.ScormService(enrollment);
      }
  </script>
  </body>
</html>
